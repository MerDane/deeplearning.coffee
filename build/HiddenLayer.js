(function(){this.HiddenLayer=function(){function t(t,i,n,o,r,s){var h,u,a,f,e,c,p;if(this.N=t,this.nIn=i,this.nOut=n,null===o)for(this.W=new Array,h=1/i,u=f=0,c=n;c>f;u=f+=1)for(this.W[u]=new Array,a=e=0,p=i;p>e;a=e+=1)this.W[u][a]=uniform(-h,h);else this.W=o;if(null===r?this.b=function(){var t,i,o;for(o=[],t=0,i=n;i>=0?i>t:t>i;i>=0?t++:t--)o.push(0);return o}():this.b=r,s===sigmoid)this.dactivation=dsigmoid;else if(s===tanh)this.dactivation=dtanh;else{if(s!==ReLU)throw new Error("activation function not supported");this.dactivation=dReLU}this.activation=s}return t.prototype.output=function(t,i,n){var o,r,s,h;for(s=0,o=r=0,h=this.nIn;h>r;o=r+=1)s+=i[o]*t[o];return s+=n,this.activation(s)},t.prototype.forward=function(t,i){var n,o,r;for(n=o=0,r=this.nOut;r>o;n=o+=1)i[n]=this.output(t,this.W[n],this.b[n])},t.prototype.backward=function(t,i,n,o,r,s){var h,u,a,f,e,c,p,d,l,v,y,b;for(null===i&&(i=function(){var t,i,n;for(n=[],t=0,i=this.nOut;i>=0?i>t:t>i;i>=0?t++:t--)n.push(0);return n}.call(this)),p=this.nOut,d=o.length,h=a=0,l=p;l>a;h=a+=1){for(i[h]=0,u=f=0,v=d;v>f;u=f+=1)i[h]+=o[u]*r[u][h];i[h]*=this.dactivation(n[h])}for(h=e=0,y=this.nOut;y>e;h=e+=1){for(u=c=0,b=this.nIn;b>c;u=c+=1)this.W[h][u]+=s*i[h]*t[u]/this.N;this.b[h]+=s*i[h]/this.N}},t.prototype.dropout=function(t,i){var n,o,r,s;for(r=[],n=o=0,s=t;s>o;n=o+=1)r.push(binomial(1,i));return r},t}()}).call(this);