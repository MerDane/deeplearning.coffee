(function(){this.Dropout=function(){function r(r,t,i,n,s){var e,h,o,a;for(this.N=r,this.nIn=t,this.hiddenLayerSizes=i,this.nLayers=i.length,this.nOut=n,this.hiddenLayers=new Array,null===s&&(s=ReLU),e=o=0,a=this.nLayers;a>o;e=o+=1)h=0===e?t:i[e-1],this.hiddenLayers.push(new HiddenLayer(r,h,i[e],null,null,s));this.logisticLayer=new LogisticRegression(r,i[this.nLayers-1],n)}return r.prototype.train=function(r,t,i,n,s,e){var h,o,a,c,d,u,y,f,L,l,p,g,w,v,S,z,A,D,R,N,O,W,E,I,U;for(a=u=0,R=r;R>u;a=u+=1)for(g=w=0,N=this.N;N>w;g=w+=1){for(h=new Array,f=new Array,c=v=0,O=this.nLayers;O>v;c=v+=1)if(y=0===c?t[g]:L.concat(),f.push(y.concat()),L=function(){var r,t,i;for(i=[],r=0,t=this.hiddenLayerSizes[c];t>=0?t>r:r>t;t>=0?r++:r--)i.push(0);return i}.call(this),this.hiddenLayers[c].forward(y,L),n===!0){for(p=this.hiddenLayers[c].dropout(L.length,s),d=A=0,W=L.length;W>A;d=A+=1)L[d]*=p[d];h.push(p.concat())}for(l=function(){var r,t,i;for(i=[],r=0,t=this.nOut;t>=0?t>r:r>t;t>=0?r++:r--)i.push(0);return i}.call(this),this.logisticLayer.train(L,i[g],e,l),f.push(L.concat()),c=D=E=this.nLayers-1;D>=0;c=D+=-1)if(c===this.nLayers-1?(S=l,z=this.logisticLayer.W):(S=o.concat(),z=this.hiddenLayers[c+1].W),o=function(){var r,t,i;for(t=[],i=0,r=this.hiddenLayerSizes[c];r>=0?r>i:i>r;r>=0?i++:i--)t.push(0);return t}.call(this),this.hiddenLayers[c].backward(f[c],o,f[c+1],S,z,e),n===!0)for(d=U=0,I=o.length;I>U;d=U+=1)o[d]*=h[c][d]}},r.prototype.pretest=function(r){var t,i,n,s,e,h,o,a,c,d,u;for(t=n=0,c=this.nLayers;c>n;t=n+=1)for(i=0===t?this.nIn:this.hiddenLayerSizes[t],o=t===this.nLayers-1?this.nOut:this.hiddenLayerSizes[t+1],s=h=0,d=o;d>h;s=h+=1)for(e=a=0,u=i;u>a;e=a+=1)this.hiddenLayers[t].W[s][e]*=1-r},r.prototype.predict=function(r,t){var i,n,s,e,h;for(i=n=0,h=this.nLayers;h>n;i=n+=1)s=0===i?r:e.concat(),e=function(){var r,t,n;for(n=[],r=0,t=this.hiddenLayerSizes[i];t>=0?t>r:r>t;t>=0?r++:r--)n.push(0);return n}.call(this),this.hiddenLayers[i].forward(s,e);this.logisticLayer.predict(e,t)},r}(),this.test_Dropout=function(){var r,t,i,n,s,e,h,o,a,c,d,u,y,f,L,l,p,g,w,v,S,z,A,D,R,N;for(this.RAND_SEED=1234,h=.1,a=3e3,D=4,S=4,c=2,i=[15,12],d=2,t=!0,f=.5,R=[[0,0],[0,1],[1,0],[1,1]],N=[[0,1],[1,0],[1,0],[0,1]],r=new Dropout(D,c,i,d,ReLU),r.train(a,R,N,t,f,h),t===!0&&r.pretest(f),z=[[0,0],[0,1],[1,0],[1,1]],A=new Array,n=e=0,l=S;l>=0?l>e:e>l;n=l>=0?++e:--e)for(A[n]=new Array,s=u=0,p=d;p>=0?p>u:u>p;s=p>=0?++u:--u)A[n][s]=0;for(v=[],n=y=0,g=S;g>=0?g>y:y>g;n=g>=0?++y:--y){for(o="",r.predict(z[n],A[n]),s=L=0,w=d;w>=0?w>L:L>w;s=w>=0?++L:--L)o+=A[n][s]+" ";v.push(console.log(o))}return v}}).call(this);